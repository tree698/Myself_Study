<h2>Description</h2>

<p>Some cells in our table have <code class="language-python">NaN</code><em> </em>as<em> </em>values: the patient gender is not defined in the prenatal hospital, and the test columns are empty in all three tables. We still cannot commit to the analysis as the statistics are not going to be objective. We have to correct the table for further study.</p>

<p>Let's take a closer look at the gender column. It's a big mess: there we have <code class="language-python">female</code>, <code class="language-python">male</code>, <code class="language-python">man</code>, <code class="language-python">woman</code>. You need to correct the data in this column. The values should be either <code class="language-python">f</code> or <code class="language-python">m</code>. Replace the empty gender column values for prenatal patients with <code class="language-python">f</code> (we can assume that the prenatal treats only women).</p>

<p>The <code class="language-python">bmi</code>, <code class="language-python">diagnosis</code>, <code class="language-python">blood_test</code>, <code class="language-python">ecg</code>, <code class="language-python">ultrasound</code>, <code class="language-python">mri</code>, <code class="language-python">xray</code>, <code class="language-python">children</code>, <code class="language-python">months</code> columns also need to be corrected. Replace the <code class="language-python">NaN</code> values of the columns above with zeros.</p>

<h2>Objectives</h2>

<p>Steps 1-5 are the same as in the previous stage. The third stage requires completing the following steps:</p>

<ol>
	<li>After all the libraries imports write the following line of code:
	<pre><code class="language-python">pd.set_option('display.max_columns', 8)</code></pre>
	</li>
	<li>Read the CSV files with datasets</li>
	<li>
	<p>Change the column names. The column names of the sports and the prenatal tables must match the column names of the general table</p>
	</li>
	<li>Merge the data frames into one. Use the <code class="language-python">ignore_index = True</code> parameter and the following order: <code class="language-python">general</code>, <code class="language-python">prenatal</code>, <code class="language-python">sports</code></li>
	<li>Delete the <code class="language-python">Unnamed: 0</code> column</li>
	<li>Delete all the empty rows</li>
	<li>Correct all the gender column values to <code class="language-python">f</code> and <code class="language-python">m</code> respectively</li>
	<li>Replace the <code class="language-python">NaN</code> values in the gender column of the prenatal hospital with <code class="language-python">f</code></li>
	<li>Replace the <code class="language-python">NaN</code> values in the <code class="language-python">bmi</code>, <code class="language-python">diagnosis</code>, <code class="language-python">blood_test</code>, <code class="language-python">ecg</code>, <code class="language-python">ultrasound</code>, <code class="language-python">mri</code>, <code class="language-python">xray</code>, <code class="language-python">children</code>, <code class="language-python">months</code> columns with zeros</li>
	<li>Print shape of the resulting data frame</li>
	<li>Print random 20 rows of the resulting data frame. For the reproducible output set <code class="language-python">random_state=30</code></li>
</ol>

<p><button
        class="btn-sm btn-outline-secondary"
        onclick="getElementById('hint-2487').style.display='inline'">
        Hint
      </button>
      <div id="hint-2487" style="display:none;">To complete the last step use <code class="language-python">pandas.DataFrame.sample(n=20, random_state=30)</code>.</div></p>

<p>If you have corrupted CSV files, please <a target="_blank" href="https://stepik.org/media/attachments/lesson/467509/files.zip" rel="noopener noreferrer nofollow">download them</a> and unzip in your working directory.</p>

<h2>Example</h2>

<p>The input is 3 CSV files, <code class="language-python">test/general.csv</code>, <code class="language-python">test/prenatal.csv</code>, and <code class="language-python">test/sports.csv</code>.</p>

<p>The output is the following:<br>
(This data is given for reference only, the actual values might be different)</p>

<pre><code class="language-no-highlight">Data shape: (442, 14)
      hospital gender   age  height  ...    mri  xray  children  months
148        NaN      m   NaN   163.0  ...   96.0     0       3.0     0.0
408  Cambridge      f   NaN   196.0  ...  189.0    no       0.0     2.0
214     Oxford      m  51.0     NaN  ...   65.0     0       3.0     1.0
67      Oxford      f   NaN     NaN  ...   97.0    no       3.0     1.0
241  Cambridge      m   NaN   199.0  ...  177.0     0       0.0     0.0
205        NaN      f  25.0   187.0  ...    0.0     0       0.0     2.0
126  Cambridge      f  50.0     NaN  ...   99.0   yes       0.0     1.0
193   Brighton      m  26.0   195.0  ...  116.0    no       0.0     1.0
338  Cambridge      m  17.0   176.0  ...  214.0     0       0.0     1.0
317        NaN      m   NaN   153.0  ...  190.0     0       3.0     1.0
344   Brighton      m   NaN     NaN  ...  200.0   yes       2.0     1.0
31         NaN      m  65.0   156.0  ...   59.0    no       2.0     0.0
164        NaN      m  53.0   150.0  ...    0.0   yes       1.0     2.0
212   Brighton      f  18.0     NaN  ...    0.0    no       0.0     0.0
213  Cambridge      f  55.0   172.0  ...    0.0   yes       2.0     2.0
201     Oxford      f   NaN   183.0  ...    0.0   yes       3.0     1.0
342   Brighton      f   NaN   189.0  ...  178.0     0       0.0     0.0
236        NaN      f   NaN   164.0  ...   67.0   yes       3.0     0.0
211        NaN      f  40.0   165.0  ...   70.0    no       0.0     1.0
384        NaN      f  29.0     NaN  ...   69.0     0       0.0     1.0

[20 rows x 14 columns]
</code></pre>
